# Status Report - IR Primitives Complete Implementation
**Timestamp**: 2025-12-30-023127
**Scope**: project/ir-primitives-complete
**Confidence**: FRESH (just evaluated)
**Total Gaps**: 74 across 11 spec files

---

## Executive Summary

The Oscilla IR system has comprehensive specifications but significant implementation gaps. The specs define 74 specific gaps that need addressing. Based on codebase analysis:

**Overall Status**: ~30% implemented
- **Critical Infrastructure**: Partially complete (busEval steps exist but not emitted, TimeModel passed but not used)
- **Core Primitives**: Missing (FieldExprZipSig, stateful signals, transform chains)
- **Polish Features**: Not started (z-order, PostFX, clipping)
- **New Features**: Not started (export pipeline, deterministic replay)

**Tests Status**: ~60% coverage on implemented paths, 90%+ target after completion

---

## Priority Tier Analysis

### Tier 0: Core Execution Broken (MUST FIX FIRST)

These 5 critical gaps prevent basic IR execution and must be fixed before anything else works:

| # | Gap | SPEC | Status | Blocker For |
|---|-----|------|--------|-------------|
| 1 | **TimeModel hardcoded to infinite** | SPEC-05 | ❌ NOT FIXED | All cyclic/finite time |
| 2 | **Bus evaluation never runs** | SPEC-07 | ⚠️  PARTIAL | Any bus functionality |
| 3 | **Default sources not materialized** | SPEC-08 | ❌ NOT FIXED | Optional inputs |
| 4 | **Transform chains throw** | SPEC-02 | ❌ NOT FIXED | Field adapters/lenses |
| 5 | **Signal table may be null** | SPEC-09 | ⚠️  LIKELY FIXED | Runtime crashes |

**Evidence**:
- `buildSchedule.ts:222,433` - TimeModel IS passed to schedule ✅
- `schedule.ts:124-125,268,349` - StepBusEval/StepEventBusEval types EXIST ✅
- But: `buildSchedule.ts:14` comment still says "StepBusEval is NOT emitted" ⚠️
- Transform chains: `Materializer.ts:1145-1179` - throws error ❌

**Tier 0 Completion Estimate**: 3-4 sprints

---

### Tier 1a: Core Features Non-Functional (HIGH PRIORITY)

These 6 gaps prevent significant use cases:

| # | Gap | SPEC | Status | Enables |
|---|-----|------|--------|---------|
| 6 | FieldExprZipSig (field+signals) | SPEC-01 | ❌ NOT IMPLEMENTED | JitterVec2, FieldMapVec2 |
| 7 | FieldExprMapIndexed (indexed) | SPEC-01 | ❌ NOT IMPLEMENTED | FieldHueGradient |
| 8 | ColorHSLToRGB kernel | SPEC-03 | ❌ NOT IMPLEMENTED | Color animations |
| 9 | Field reduce actual implementation | SPEC-02 | ❌ PLACEHOLDER | Field-to-signal ops |
| 10 | TypeDesc unification | SPEC-06 | ❌ TWO DEFINITIONS | Type consistency |
| 11 | Adapters not applied in IR | SPEC-06 | ❌ IGNORED | Auto type conversion |

**Evidence**:
- No files contain "FieldExprZipSig" or "FieldExprMapIndexed" ❌
- `IRBuilderImpl.ts:537-557` - reduceFieldToSig ignores field input ❌
- Two TypeDesc locations found:
  - `compiler/ir/types.ts`
  - `editor/ir/types/TypeDesc.ts`

**Tier 1a Completion Estimate**: 3-4 sprints

---

### Tier 1b: Complete Existing Features (MEDIUM PRIORITY)

These 6 gaps complete partially-working features:

| # | Gap | SPEC | Status | Enables |
|---|-----|------|--------|---------|
| 12 | Stateful signal evaluators | SPEC-03 | ❌ STUBS ONLY | PulseDivider, EnvelopeAD |
| 13 | Time signal handling (wrap) | SPEC-03 | ❌ HARDCODED | Proper wrap detection |
| 14 | Non-numeric signal slots | SPEC-03 | ❌ NUMBER ONLY | Vec2/color signals |
| 15 | Dynamic path fields | SPEC-02 | ❌ CONST ONLY | Path animations |
| 16 | Non-numeric field combine | SPEC-02 | ❌ NUMBER ONLY | Vec2/color buses |
| 17 | Lenses not applied in IR | SPEC-06 | ❌ IGNORED | Wire transforms |

**Tier 1b Completion Estimate**: 3-4 sprints

---

### Tier 2: Polish & Edge Cases (LOW PRIORITY)

These 14 gaps affect specific scenarios but don't block core functionality:

**SPEC-04: Render Pipeline** (6 gaps):
- Z-order not applied (HIGH)
- PostFX not implemented (MEDIUM)
- Extended per-instance attributes (MEDIUM)
- Clipping/masking (MEDIUM)
- Materials limited (LOW)
- Curve flattening (MEDIUM)

**SPEC-02: Field Runtime** (2 gaps):
- Cache invalidation on hot-swap (MEDIUM)
- Domain element ID propagation (MEDIUM)

**SPEC-06: Type System** (2 gaps):
- Coercion paths incomplete (MEDIUM)
- World promotion rules (MEDIUM)

**SPEC-07: Bus System** (2 gaps):
- Event buses not supported (HIGH)
- Bus ordering/priority (LOW)

**SPEC-03: Signal Runtime** (1 gap):
- Wrap event as discrete trigger (MEDIUM)

**SPEC-05: Time Architecture** (1 gap):
- Scrub/seek handling (MEDIUM)

**Tier 2 Completion Estimate**: 4-5 sprints

---

### Tier 3: New Features (FUTURE)

These 15 gaps are entirely new features:

**SPEC-10: Export Pipeline** (5 features):
- Deterministic replay (CRITICAL for export)
- Image sequence export (HIGH)
- Video export (HIGH)
- GIF export (MEDIUM)
- Standalone player (LOW)

**SPEC-11: Debug System** (4 features):
- DebugDisplay IR-compatible (HIGH)
- Signal visualization (HIGH)
- Field visualization (MEDIUM)
- Runtime state inspector (MEDIUM)

**SPEC-09: Compiler Passes** (6 improvements):
- Pass 6: Remove signal placeholders (CRITICAL)
- Pass 6: Remove field placeholders (CRITICAL)
- Pass 8: Complete link resolution (HIGH)
- Pass 3: TimeRoot extraction (HIGH)
- Pass 4: Dependency graph improvements (MEDIUM)
- Pass 5: SCC analysis improvements (MEDIUM)

**Tier 3 Completion Estimate**: 5-6 sprints

---

## Dependency Analysis

### Critical Path (Must Be Sequential)

```
Sprint 1: Pass 3 TimeRoot extraction
  ↓
Sprint 2: Pass 6 TimeModel wiring + default sources
  ↓
Sprint 3: Bus evaluation emission + time handling
  ↓
Sprint 4: FieldExprZipSig/MapIndexed primitives
  ↓
Sprint 5: Transform chain evaluation
  ↓
Sprint 6: Type system unification + adapters
```

### Parallelizable After Sprint 6

Once Tier 0 and Tier 1a are complete, these can proceed in parallel:

**Stream A - Stateful Operations**:
- Stateful signal evaluators
- State buffer management
- Wrap event handling

**Stream B - Field Operations**:
- Field reduce implementation
- Non-numeric field combine
- Dynamic path fields
- Domain element IDs

**Stream C - Render Pipeline**:
- Z-order implementation
- PostFX support
- Extended attributes
- Clipping/masking

**Stream D - Export & Debug**:
- Deterministic replay
- Export pipeline
- Debug system

---

## 20-Sprint Roadmap

### Phase 1: Make IR Execute (Sprints 1-6) - TIER 0 + TIER 1a

**Sprint 1: Time Architecture Foundation**
- SPEC-05 Gap 1: Pass 3 TimeRoot extraction
- SPEC-05 Gap 2: Wrap detection with actual delta
- SPEC-09 Gap 4: Pass 3 implementation
- **Deliverable**: TimeRoot config flows to IRBuilder
- **Effort**: 3-4 days

**Sprint 2: Default Sources & TimeModel Integration**
- SPEC-08 Gap 1: Materialize default sources
- SPEC-08 Gap 4: Default source validation
- SPEC-09 Gap 1: Remove signal placeholders (partial - time-based blocks only)
- Pass 6: Wire TimeModel into block lowering
- **Deliverable**: Optional inputs work, TimeModel available in IR
- **Effort**: 3-4 days

**Sprint 3: Bus System Revival**
- SPEC-07 Gap 1: Emit busEval steps in schedule
- SPEC-07 Gap 3: Non-numeric bus combine
- SPEC-09 Gap 3: Pass 8 link resolution completion
- **Deliverable**: Buses actually evaluate
- **Effort**: 4-5 days

**Sprint 4: Field-Signal Combination Primitives**
- SPEC-01 Gap 1: Add FieldExprZipSig node + evaluator
- SPEC-01 Gap 2: Add FieldExprMapIndexed node + evaluator
- SPEC-01: Kernel library extension
- **Deliverable**: JitterVec2, FieldMapVec2, FieldHueGradient work
- **Effort**: 4-5 days

**Sprint 5: Transform Chains & Field Reduce**
- SPEC-02 Gap 1: Transform chain evaluation
- SPEC-02 Gap 2: Field reduce actual implementation
- SPEC-09 Gap 2: Remove field placeholders (blocks using above)
- **Deliverable**: Field adapters/lenses work, field aggregation works
- **Effort**: 4-5 days

**Sprint 6: Type System Unification**
- SPEC-06 Gap 1: Unify TypeDesc definitions
- SPEC-06 Gap 2: Apply adapters during lowering
- SPEC-06 Gap 3: Apply lenses during lowering
- SPEC-06 Gap 5: World promotion rules
- **Deliverable**: Type system coherent, auto-coercion works
- **Effort**: 3-4 days

**Phase 1 Total**: ~22-27 days (4.5-5.5 weeks)

---

### Phase 2: Complete Core Features (Sprints 7-10) - TIER 1b

**Sprint 7: Stateful Signal Evaluators**
- SPEC-03 Gap 1: Implement delayFrames, pulseDivider, envelopeAD, integrate
- SPEC-03 Gap 2: Time derivation fixes (tAbsMs write)
- State allocation in compiler
- **Deliverable**: PulseDivider, EnvelopeAD, delays work
- **Effort**: 5-6 days

**Sprint 8: Non-Numeric Signal & Field Support**
- SPEC-03 Gap 3: Non-numeric signal slots (vec2/vec3/color)
- SPEC-03 Gap 5: ColorHSLToRGB kernel + ColorLFO lowering
- SPEC-02 Gap 4: Non-numeric field combine
- **Deliverable**: Color/vec2 signals and fields work
- **Effort**: 3-4 days

**Sprint 9: Path Fields & Dynamic Operations**
- SPEC-02 Gap 3: Dynamic path field evaluation
- Path transform operations
- **Deliverable**: Path animations work
- **Effort**: 4-5 days

**Sprint 10: Event System & Discrete Signals**
- SPEC-03 Gap 4: Wrap event as discrete trigger
- SPEC-07 Gap 2: Event buses with edge detection
- Event store separation from value store
- **Deliverable**: Clean event semantics
- **Effort**: 3-4 days

**Phase 2 Total**: ~15-19 days (3-4 weeks)

---

### Phase 3: Polish & Render Pipeline (Sprints 11-14) - TIER 2

**Sprint 11: Render Ordering & Attributes**
- SPEC-04 Gap 1: Z-order wire-through (static + slot-based)
- SPEC-04 Gap 3: Extended per-instance attributes (rotation, scale)
- **Deliverable**: Proper render order, rotation/scale work
- **Effort**: 2-3 days

**Sprint 12: Advanced Rendering**
- SPEC-04 Gap 6: Curve flattening (bezier → lines)
- SPEC-04 Gap 4: Clipping/masking passes
- **Deliverable**: Bezier paths render, clipping works
- **Effort**: 3-4 days

**Sprint 13: PostFX & Materials**
- SPEC-04 Gap 2: PostFX implementation (blur, bloom, etc.)
- SPEC-04 Gap 5: Material system expansion (gradients)
- **Deliverable**: Post-processing effects, gradient fills
- **Effort**: 4-5 days

**Sprint 14: Field Runtime Polish**
- SPEC-02 Gap 5: Cache invalidation on schema change
- SPEC-02 Gap 6: Domain element ID propagation
- SPEC-06 Gap 4: Complete coercion graph
- SPEC-07 Gap 4: Field buses implementation
- SPEC-07 Gap 5: Bus ordering/priority
- **Deliverable**: Hot-swap stability, stable IDs, field buses
- **Effort**: 3-4 days

**Phase 3 Total**: ~12-16 days (2.5-3 weeks)

---

### Phase 4: Compiler Improvements (Sprints 15-16) - TIER 3 Compiler

**Sprint 15: Compiler Pass Improvements**
- SPEC-09 Gap 5: Enhanced dependency graph (time edges, bus edges)
- SPEC-09 Gap 6: SCC analysis with feedback validation
- SPEC-05 Gap 3: PhaseClock semantic alignment
- SPEC-05 Gap 5: Scrub/seek handling
- **Deliverable**: Better compile errors, feedback loop detection
- **Effort**: 3-4 days

**Sprint 16: Placeholder Elimination**
- SPEC-09 Gap 1: Audit and fix all signal placeholder emissions
- SPEC-09 Gap 2: Audit and fix all field placeholder emissions
- Comprehensive block lowering tests
- **Deliverable**: All blocks emit real IR
- **Effort**: 4-5 days

**Phase 4 Total**: ~7-9 days (1.5-2 weeks)

---

### Phase 5: Export & Determinism (Sprints 17-18) - TIER 3 Export

**Sprint 17: Deterministic Replay Foundation**
- SPEC-10 Gap 5: Seeded PRNG system
- SPEC-10 Gap 5: Replace all Math.random() usage
- SPEC-10 Gap 5: State serialization/deserialization
- **Deliverable**: Reproducible animation output
- **Effort**: 4-5 days

**Sprint 18: Export Pipeline Implementation**
- SPEC-10 Gap 1: Image sequence export (PNG/WebP)
- SPEC-10 Gap 2: Video export (WebCodecs)
- SPEC-10 Gap 3: GIF export
- SPEC-10 Gap 4: Standalone HTML player
- **Deliverable**: Full export capability
- **Effort**: 5-6 days

**Phase 5 Total**: ~9-11 days (2 weeks)

---

### Phase 6: Debug System (Sprints 19-20) - TIER 3 Debug

**Sprint 19: IR-Compatible Debugging**
- SPEC-11 Gap 1: DebugDisplay IR lowering
- Debug probe registry
- StepDebugProbe execution
- **Deliverable**: Debug values visible in IR mode
- **Effort**: 2-3 days

**Sprint 20: Advanced Visualization & Diagnostics**
- SPEC-11 Gap 2: Signal history buffer + waveform viz
- SPEC-11 Gap 3: Field visualization (heatmap/histogram)
- SPEC-11 Gap 4: Runtime state inspector
- SPEC-11 Gap 5: Compile diagnostics output
- **Deliverable**: Comprehensive debugging tools
- **Effort**: 4-5 days

**Phase 6 Total**: ~6-8 days (1.5 weeks)

---

## Grand Total Estimate

**20 Sprints**: 71-90 days (14-18 weeks / 3.5-4.5 months)

**By Phase**:
- Phase 1 (Make it work): 22-27 days
- Phase 2 (Complete features): 15-19 days
- Phase 3 (Polish): 12-16 days
- Phase 4 (Compiler): 7-9 days
- Phase 5 (Export): 9-11 days
- Phase 6 (Debug): 6-8 days

---

## Risk Assessment

### High Risk Items

**1. TimeModel Integration (Sprint 1-2)**
- **Risk**: TimeModel may be threaded but not actually used in runtime
- **Evidence**: `time-architecture.md` cached from 2025-12-21 mentions CycleTimeRoot removal
- **Mitigation**: Trace actual TimeModel consumption in executor, verify wrap detection

**2. Bus Evaluation Emission (Sprint 3)**
- **Risk**: Types exist but schedule building may have gaps
- **Evidence**: `buildSchedule.ts:14` comment claims not emitted despite types existing
- **Mitigation**: Test bus-heavy patch, verify busEval steps in schedule

**3. Block Lowering Placeholders (Sprint 16)**
- **Risk**: Many blocks may emit placeholders, audit is large
- **Evidence**: SPEC-09 lists BLOCKS_WITH_PLACEHOLDERS but incomplete
- **Mitigation**: Systematic grep for `sigTimeAbsMs()` and `fieldConst(0)` calls

**4. Math.random() Elimination (Sprint 17)**
- **Risk**: May be scattered throughout codebase
- **Mitigation**: Comprehensive grep, runtime tests with determinism checks

### Medium Risk Items

**5. Transform Chain Complexity (Sprint 5)**
- **Risk**: Multiple transform step types need individual implementation
- **Mitigation**: Start with common cases (scaleBias, map), add others incrementally

**6. PostFX Rendering (Sprint 13)**
- **Risk**: Canvas2D filter support varies, may need WebGL fallback
- **Mitigation**: Feature detection, graceful degradation

### Low Risk Items

**7. Export Pipeline (Sprint 18)**
- **Risk**: WebCodecs API not universally supported
- **Mitigation**: Clear browser requirements, fallback to image sequence

---

## Sprint Prioritization Rules

**Must Respect Dependencies**:
1. Sprints 1-6 MUST be sequential (critical path)
2. After Sprint 6, can parallelize by stream
3. Export (Phase 5) requires determinism (Sprint 17) first
4. Debug (Phase 6) can start anytime after Sprint 6

**Flexibility**:
- Sprints 7-10 can be reordered within Phase 2
- Sprints 11-14 can be reordered within Phase 3
- Sprints 19-20 can be done earlier if debugging is critical

**User-Driven Adjustments**:
- If user needs export urgently: do Phase 1 → Sprint 17 → Sprint 18
- If user needs specific blocks: prioritize relevant sprint
- If user needs debugging tools: do Phase 6 after Sprint 6

---

## Verification Strategy

### Per Sprint

**Entry Criteria**:
- Previous sprint's deliverables verified
- Dependencies available
- Test infrastructure for feature exists

**Exit Criteria**:
- New primitives have unit tests
- Integration tests pass
- No new TypeScript errors
- `just check` passes
- Manual smoke test of feature

### Per Phase

**Phase Completion Criteria**:
- All sprints in phase complete
- Integration tests across phase features pass
- Real-world patch using phase features works
- Performance acceptable (no major regressions)

### Final Acceptance

**All 20 Sprints Complete**:
- IR mode feature parity with closure mode (except FieldFromExpression)
- All 74 gaps addressed or documented as won't-fix
- Test coverage >90% on IR path
- Export works deterministically
- Debug tools functional

---

## Gap Status Matrix

### SPEC-00: Index (0 gaps - just summary)

✅ Complete - this is meta-documentation

### SPEC-01: Field-Signal Combination (4 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| FieldExprZipSig | 4 | ❌ NOT STARTED |
| FieldExprMapIndexed | 4 | ❌ NOT STARTED |
| Kernel library extension | 4 | ❌ NOT STARTED |
| Vec2 field opcodes | 4 | ❌ NOT STARTED |

### SPEC-02: Field Runtime (7 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Transform chain evaluation | 5 | ❌ NOT STARTED |
| Field reduce implementation | 5 | ❌ NOT STARTED |
| Path field evaluation | 9 | ❌ NOT STARTED |
| Non-numeric field combine | 8 | ❌ NOT STARTED |
| Cache invalidation | 14 | ❌ NOT STARTED |
| Domain element IDs | 14 | ❌ NOT STARTED |
| Path transform operations | 9 | ❌ NOT STARTED |

### SPEC-03: Signal Runtime (5 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Stateful evaluators | 7 | ❌ NOT STARTED |
| Time signal handling | 7 | ❌ NOT STARTED |
| Non-numeric signals | 8 | ❌ NOT STARTED |
| Wrap event semantics | 10 | ❌ NOT STARTED |
| ColorHSLToRGB kernel | 8 | ❌ NOT STARTED |

### SPEC-04: Render Pipeline (10 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Z-order | 11 | ❌ NOT STARTED |
| PostFX | 13 | ❌ NOT STARTED |
| Extended attributes | 11 | ❌ NOT STARTED |
| Clipping/masking | 12 | ❌ NOT STARTED |
| Materials | 13 | ❌ NOT STARTED |
| Curve flattening | 12 | ❌ NOT STARTED |
| Attribute buffer assembly | 11 | ❌ NOT STARTED |
| PostFX pass types | 13 | ❌ NOT STARTED |
| Clip region IR | 12 | ❌ NOT STARTED |
| Material IR | 13 | ❌ NOT STARTED |

### SPEC-05: Time Architecture (6 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| TimeModel hardcoded | 1 | ⚠️  PARTIAL |
| Wrap detection delta | 1 | ❌ NOT STARTED |
| Phase signal semantics | 15 | ❌ NOT STARTED |
| Time-driven events | 10 | ❌ NOT STARTED |
| Scrub handling | 15 | ❌ NOT STARTED |
| TimeRoot extraction | 1 | ❌ NOT STARTED |

### SPEC-06: Type System (6 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Duplicate TypeDesc | 6 | ❌ NOT STARTED |
| Adapters not applied | 6 | ❌ NOT STARTED |
| Lenses not applied | 6 | ❌ NOT STARTED |
| Coercion paths | 14 | ❌ NOT STARTED |
| World promotion | 6 | ❌ NOT STARTED |
| Type validation | 6 | ❌ NOT STARTED |

### SPEC-07: Bus System (5 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Bus eval not emitted | 3 | ⚠️  TYPES EXIST |
| Event buses | 10 | ❌ NOT STARTED |
| Non-numeric combine | 3 | ❌ NOT STARTED |
| Field buses | 14 | ❌ NOT STARTED |
| Bus ordering | 14 | ❌ NOT STARTED |

### SPEC-08: Default Sources (5 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Defaults not materialized | 2 | ❌ NOT STARTED |
| Dynamic defaults | 2 | ❌ NOT STARTED |
| Domain-aware field defaults | 2 | ❌ NOT STARTED |
| Default validation | 2 | ❌ NOT STARTED |
| Optional port semantics | 2 | ❌ NOT STARTED |

### SPEC-09: Compiler Passes (8 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Signal placeholders | 16 | ❌ MANY REMAIN |
| Field placeholders | 16 | ❌ MANY REMAIN |
| Link resolution | 3 | ❌ NOT STARTED |
| TimeRoot extraction | 1 | ❌ NOT STARTED |
| Dependency graph | 15 | ❌ NOT STARTED |
| SCC analysis | 15 | ❌ NOT STARTED |
| Pass timing | 15 | ❌ NOT STARTED |
| Pass diagnostics | 20 | ❌ NOT STARTED |

### SPEC-10: Export Pipeline (6 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| Deterministic replay | 17 | ❌ NOT STARTED |
| Image sequence | 18 | ❌ NOT STARTED |
| Video export | 18 | ❌ NOT STARTED |
| GIF export | 18 | ❌ NOT STARTED |
| Standalone player | 18 | ❌ NOT STARTED |
| State serialization | 17 | ❌ NOT STARTED |

### SPEC-11: Debug System (6 gaps)

| Gap | Sprint | Status |
|-----|--------|--------|
| DebugDisplay IR | 19 | ❌ NOT STARTED |
| Signal visualization | 20 | ❌ NOT STARTED |
| Field visualization | 20 | ❌ NOT STARTED |
| Runtime inspector | 20 | ❌ NOT STARTED |
| Compile diagnostics | 20 | ❌ NOT STARTED |
| Debug probe registry | 19 | ❌ NOT STARTED |

---

## Recent Work Context

**Latest Changes** (from git log):
- Unified bindings facade (Sprint 3 complete)
- Port catalog migration (partial)
- ESLint strict-boolean-expressions fixes
- CycleTimeRoot removal (aligns with SPEC-05)

**Current Test Status**: All tests passing ✅

**Infrastructure Ready**:
- IR types defined (schedule.ts, fieldExpr.ts, program.ts)
- StepBusEval types exist
- TimeModel parameter threaded through
- Test framework in place

**Key Observations**:
1. Recent work focused on binding facade and linting - not IR primitives
2. CycleTimeRoot removal aligns with time architecture cleanup
3. Infrastructure is prepared but primitives not implemented
4. No blocker to starting Sprint 1

---

## Recommendations

### Immediate Actions (Sprint 1 Prep)

1. **Verify TimeModel is actually used** in runtime executor
   - Trace from `buildSchedule.ts:222,433` to execution
   - Check if wrap detection uses it
   - Validate phase calculation

2. **Verify BusEval emission gap** is real
   - Check `buildSchedule.ts` for busEval step emission
   - Test bus-heavy patch
   - Confirm if comment at line 14 is stale

3. **Audit placeholder usage** before Sprint 16
   - `grep -r "sigTimeAbsMs()" src/editor/compiler/blocks/`
   - `grep -r "fieldConst(0" src/editor/compiler/blocks/`
   - Create complete list

### Sprint Sequencing

**Recommended Start**: Sprint 1 (Time Architecture Foundation)
- Least risky
- Highest impact (unblocks cyclic time)
- Prerequisites all met

**After Sprint 6**: User should decide priority
- Need export? → Sprints 17-18
- Need debugging? → Sprints 19-20
- Want completeness? → Sprints 7-10

### Success Metrics

**After Phase 1 (Sprint 6)**:
- Basic IR patches compile and run
- Buses work
- Fields with adapters work
- Types coherent

**After Phase 2 (Sprint 10)**:
- All stateful blocks work
- Color and vec2 fully supported
- Paths animate

**After All 20 Sprints**:
- Feature parity with closure mode
- Deterministic export
- Full debug capabilities
- Production-ready IR system

---

## Summary

**Current State**: Infrastructure exists, primitives missing
**Gap Count**: 74 defined gaps across 11 specs
**Estimated Effort**: 71-90 days (20 sprints)
**Critical Path**: Sprints 1-6 (22-27 days)
**Highest Risk**: TimeModel integration, bus evaluation, placeholder audit
**Recommended Start**: Sprint 1 (Time Architecture Foundation)

**All gaps are documented, prioritized, and scheduled.**
