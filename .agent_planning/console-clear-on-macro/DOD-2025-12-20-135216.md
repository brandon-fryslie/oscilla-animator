# Definition of Done: Console Clear on Macro Load

**Generated**: 2025-12-20-135216
**Plan**: PLAN-2025-12-20-135216.md
**Topic**: console-clear-on-macro

---

## Acceptance Criteria

### [P0] Add Log Clear Hook to Macro Expansion
- [ ] Import `logStore` singleton at top of `src/editor/stores/PatchStore.ts`
- [ ] Add conditional clear immediately after `this.root.clearPatch()` call (line 231)
- [ ] Implementation checks `logStore.autoClearOnMacro` before calling `logStore.clear()`
- [ ] TypeScript compilation succeeds (`just typecheck`)

### [P1] Add Test Coverage for Auto-Clear Behavior
- [ ] Create test file `src/editor/__tests__/macro-log-clear.test.ts`
- [ ] Test case: Logs cleared when `autoClearOnMacro = true` during macro expansion
- [ ] Test case: Logs preserved when `autoClearOnMacro = false` during macro expansion
- [ ] Test case: Setting toggle persists across multiple macro expansions
- [ ] All tests pass (`just test`)

### [P2] Manual Smoke Test
- [ ] Open app, add multiple log entries manually
- [ ] Load a macro from preset library (e.g., "Breathing Constellation")
- [ ] Verify logs are cleared when auto-clear is enabled (default)
- [ ] Disable "Auto-clear" checkbox in LogWindow
- [ ] Load macro again, verify logs are preserved
- [ ] Re-enable "Auto-clear", load macro, verify logs cleared again

---

## Sprint Scope

**This sprint delivers**: Auto-clear console logs when loading macros (user-configurable)

**Deferred**: None (complete feature)

---

## Validation Checklist

- [ ] Code changes: Import added, 3-line hook added to `expandMacro()`
- [ ] Tests: New test file created with 3+ test cases
- [ ] Type safety: `just typecheck` passes
- [ ] Test suite: `just test` passes
- [ ] Manual verification: Smoke test completed successfully
- [ ] No regressions: Existing functionality unaffected
