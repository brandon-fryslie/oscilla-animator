# Definition of Done: Render Pipeline Primitives

## Acceptance Criteria

### Gap 1: Z-Order Applied
- [ ] `executeRenderAssemble.ts` reads z-order from batch descriptor (static or slot)
- [ ] RenderSinkIR includes `zOrder?: number` and `zOrderSlot?: ValueSlot`
- [ ] Passes are sorted by z-order before rendering
- [ ] Test: overlapping elements render in correct z-order

### Gap 2: Curve Flattening Implemented
- [ ] De Casteljau algorithm implemented in `executeMaterializePath.ts`
- [ ] Cubic bezier commands (PathCmd.CUBIC) flatten to line segments
- [ ] Quadratic bezier commands (PathCmd.QUAD) flatten to line segments
- [ ] Tolerance parameter controls segment density
- [ ] Test: bezier path renders as smooth curve

### Gap 3: Clipping/Masking Supported
- [ ] ClipRegionIR type defined (rect, path, circle)
- [ ] ClipGroupPassIR type defined with children
- [ ] Canvas renderer applies clip before rendering children
- [ ] Test: instances clip to rectangular region

### Gap 4: Extended Per-Instance Attributes
- [ ] Instance2DBatch supports `rotation?: ValueSlot`
- [ ] Instance2DBatch supports `scaleXY?: ValueSlot`
- [ ] assembleInstanceBuffers extracts rotation/scale buffers
- [ ] Canvas renderer applies rotation/scale per instance
- [ ] Test: instances rotate and scale independently

### Gap 5: PostFX Implemented
- [ ] PostFXPassIR type defined with effect variants
- [ ] Blur effect implemented using canvas filter
- [ ] Bloom effect implemented (multi-pass)
- [ ] Canvas renderer handles postfx pass type
- [ ] Test: blur effect applies to rendered content

### Gap 6: Material System Extended
- [ ] MaterialIR supports gradient type with stops
- [ ] Canvas renderer creates linear/radial gradients
- [ ] Gradient stops support offset and color
- [ ] Test: instance renders with gradient fill

## Validation

- All existing tests pass
- TypeScript compiles without errors
- ESLint passes
- Manual verification in dev server for each gap
