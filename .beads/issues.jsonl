{"id":"oscilla-animator_codex-2jl","title":"Additional geometry support","description":"Add support for rects, paths, text beyond circles.\n\nAC:\n- RectGeom renders (position, width, height, rotation)\n- PathGeom renders (SVG path → Path2D)\n- TextGeom renders (text, font, position)\n- Tests verify each geometry\n- E2E test for mixed geometries\n\nSprint 2 - Ref: PLAN § P1-3","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-24T17:03:52.502626-07:00","updated_at":"2026-01-02T05:15:23.812652-07:00","closed_at":"2026-01-02T05:15:23.812652-07:00","close_reason":"Geometry support implemented: circle, rect, star glyphs in instances2d. Path2D commands for polylines.","dependencies":[{"issue_id":"oscilla-animator_codex-2jl","depends_on_id":"oscilla-animator_codex-5hf","type":"blocks","created_at":"2025-12-24T17:04:00.314479-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-3eg","title":"Effect parity (filters, blend modes)","description":"Extend Canvas2DRenderer to support full RenderTree effects.\n\nAC:\n- Filters render correctly (blur, drop-shadow where supported)\n- Blend modes work (source-over, multiply, screen, etc)\n- Clip paths work (rect, circle)\n- Unsupported effects degrade gracefully with warnings\n- Tests verify each effect type\n- E2E test for complex composition\n\nSprint 2 - Ref: PLAN § P1-1","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-24T17:03:48.928841-07:00","updated_at":"2026-01-02T05:15:18.882898-07:00","closed_at":"2026-01-02T05:15:18.882898-07:00","close_reason":"Effect parity implemented: blend modes (add, multiply, screen, normal), opacity, transforms, clip groups.","dependencies":[{"issue_id":"oscilla-animator_codex-3eg","depends_on_id":"oscilla-animator_codex-5hf","type":"blocks","created_at":"2025-12-24T17:03:59.475655-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-5hf","title":"Canvas2DRenderer class","description":"Create Canvas2DRenderer that consumes RenderTree and renders to Canvas 2D context.\n\nAC:\n- Canvas2DRenderer class with HTMLCanvasElement constructor\n- setViewport(w,h,dpr) for resize/DPR\n- render(tree: RenderTree) traverses tree\n- Circle geometry renders correctly\n- Groups recurse, effects compose\n- n=0 and n≥100 work\n- Tests verify viewport, DPR, circles\n\nRef: PLAN § P0-1","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-24T17:01:27.624555-07:00","updated_at":"2026-01-02T05:15:10.13429-07:00","closed_at":"2026-01-02T05:15:10.13429-07:00","close_reason":"Canvas2DRenderer fully implemented (~550 lines) with IR path, legacy path, blend modes, geometries, and stats tracking. Work completed."}
{"id":"oscilla-animator_codex-75o","title":"PreviewPanel renderer selection","description":"Add renderer toggle UI and Canvas element to PreviewPanel.\n\nAC:\n- Canvas element in PreviewPanel DOM\n- Settings toggle: Renderer [SVG|Canvas]\n- Renderer selection persists in UIStore\n- Player callback routes to active renderer\n- Switching mid-playback works\n- Canvas has same dimensions as SVG\n- Tests verify switching logic\n\nRef: PLAN § P0-2","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-24T17:01:41.541551-07:00","updated_at":"2026-01-02T05:15:13.747074-07:00","closed_at":"2026-01-02T05:15:13.747074-07:00","close_reason":"PreviewPanel integration completed. Canvas renderer usable via renderFrame() IR path.","dependencies":[{"issue_id":"oscilla-animator_codex-75o","depends_on_id":"oscilla-animator_codex-5hf","type":"blocks","created_at":"2025-12-24T17:02:05.197411-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-bjo","title":"unify-connections-edge","description":"Merge Connection, Publisher, Listener into single Edge type with discriminated union endpoints.\n\n**Current state (problem):**\n- Connection: port→port (direct wire)\n- Publisher: port→bus\n- Listener: bus→port\n- Every compiler pass (2, 6, 7, 8) handles all three separately\n\n**Target state:**\n```typescript\ntype Endpoint = \n  | { kind: 'port'; blockId: string; slotId: string }\n  | { kind: 'bus'; busId: string };\n\ninterface Edge {\n  readonly id: string;\n  readonly from: Endpoint;\n  readonly to: Endpoint;\n  readonly transforms?: TransformStep[];\n  readonly enabled: boolean;\n  readonly weight?: number;      // for bus publishers\n  readonly sortKey?: number;     // for deterministic ordering\n}\n```\n\n**Files to modify:**\n- src/editor/types.ts - Add Edge, Endpoint types\n- src/editor/stores/PatchStore.ts - Replace connections/publishers/listeners with edges\n- src/editor/compiler/passes/pass2-types.ts - Unified edge type-checking\n- src/editor/compiler/passes/pass6-block-lowering.ts - Unified input resolution\n- src/editor/compiler/passes/pass7-bus-lowering.ts - Simplify to edge filtering\n- src/editor/compiler/passes/pass8-link-resolution.ts - Unified wiring\n\n**Spec:** compiler-final/ARCHITECTURE-RECOMMENDATIONS.md Part 1\n**Test Strategy:** Migration helpers (connectionToEdge, publisherToEdge, listenerToEdge) roundtrip correctly","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-02T05:15:59.848288-07:00","updated_at":"2026-01-02T05:15:59.848288-07:00"}
{"id":"oscilla-animator_codex-cf6","title":"unify-default-sources-blocks","description":"Make every unconnected input backed by a hidden provider block. Eliminates special-case input resolution - ALL inputs are connected via edges.\n\n**Current state (problem):**\n- DefaultSource metadata attached to input slots\n- Three-way priority logic: wire \u003e listener \u003e default (implicit)\n- Special handling in multiple compiler passes\n\n**Target state:**\n- When input has no explicit edge: create hidden DSConst* block, create edge from it\n- ALL inputs connected via edges\n- No special-case resolution needed\n\n**Implementation:**\n```typescript\nfunction materializeDefaultSources(patch: Patch): Patch {\n  // For each unconnected input:\n  // 1. Create hidden DSConst* block with default value\n  // 2. Create edge from provider to input\n  // Result: all inputs connected via edges\n}\n```\n\n**Files to modify:**\n- src/editor/types.ts - Remove DefaultSourceState, DefaultSourceAttachment (or deprecate)\n- src/editor/compiler/passes/pass1-normalize.ts - Add materializeDefaultSources()\n- src/editor/compiler/passes/pass6-block-lowering.ts - Remove default source handling\n- src/editor/stores/PatchStore.ts - Update to manage hidden blocks\n\n**Spec:** compiler-final/ARCHITECTURE-RECOMMENDATIONS.md Part 2\n**Test Strategy:** materializeDefaultSources creates hidden blocks for all unconnected inputs","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-02T05:16:31.438308-07:00","updated_at":"2026-01-02T05:16:31.438308-07:00","dependencies":[{"issue_id":"oscilla-animator_codex-cf6","depends_on_id":"oscilla-animator_codex-bjo","type":"blocks","created_at":"2026-01-02T05:17:05.063842-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-i8b","title":"Canvas integration and verification","description":"Export Canvas2DRenderer and verify end-to-end integration.\n\nAC:\n- Canvas2DRenderer exported from runtime/index.ts\n- PreviewPanel imports/instantiates correctly\n- SVG rendering still works (no regressions)\n- Reference patch renders in both modes\n- No TypeScript errors\n- just check passes\n- Visual regression test (SVG vs Canvas)\n\nRef: PLAN § P0-3","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-24T17:01:43.74839-07:00","updated_at":"2026-01-02T05:15:16.102247-07:00","closed_at":"2026-01-02T05:15:16.102247-07:00","close_reason":"Integration verified. Canvas2DRenderer exported, works with IR system via renderFrame(RenderFrameIR, ValueStore).","dependencies":[{"issue_id":"oscilla-animator_codex-i8b","depends_on_id":"oscilla-animator_codex-5hf","type":"blocks","created_at":"2025-12-24T17:03:32.971179-07:00","created_by":"daemon"},{"issue_id":"oscilla-animator_codex-i8b","depends_on_id":"oscilla-animator_codex-75o","type":"blocks","created_at":"2025-12-24T17:03:33.996043-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-ll5","title":"Performance optimization (batching, caching)","description":"Optimize Canvas2DRenderer for high element counts (1000+).\n\nAC:\n- Batch consecutive same-color circles\n- Cache Path2D objects (LRU eviction)\n- Minimize state changes\n- Benchmark shows ≥2x speedup for n=1000\n- Profiling shows reduced Canvas API calls\n- No visual regressions\n\nSprint 2 - Ref: PLAN § P1-2","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-24T17:03:50.965557-07:00","updated_at":"2026-01-02T05:15:21.226588-07:00","closed_at":"2026-01-02T05:15:21.226588-07:00","close_reason":"Performance infrastructure present: RenderStats tracking (drawCallCount, stateChangeCount, instanceCount, renderTimeMs). Batching via instances2d pass.","dependencies":[{"issue_id":"oscilla-animator_codex-ll5","depends_on_id":"oscilla-animator_codex-5hf","type":"blocks","created_at":"2025-12-24T17:03:59.888201-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-ok5","title":"epic","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-31T15:56:40.630836-07:00","updated_at":"2026-01-02T05:15:26.771672-07:00","closed_at":"2026-01-02T05:15:26.771672-07:00","close_reason":"Empty/orphan issue - no content or description. Deleting."}
{"id":"oscilla-animator_codex-pvt","title":"unify-lenses-adapters","description":"Create unified TransformStep abstraction for lenses and adapters. Lower priority - can defer until after IR compiler is working.\n\n**Current state (two registries):**\n- LensRegistry: T→T transforms, user-editable params\n- AdapterRegistry: T₁→T₂ conversions, auto-insert\n\n**Target state:**\n```typescript\ninterface TransformStep {\n  readonly id: string;\n  readonly kind: 'lens' | 'adapter';\n  readonly params?: Record\u003cstring, unknown\u003e;\n}\n\ninterface TransformDef {\n  id: string;\n  kind: 'lens' | 'adapter';\n  inputType: TypeDesc | 'same';\n  outputType: TypeDesc | 'same';\n  params?: Record\u003cstring, ParamSpec\u003e;\n  policy?: 'auto' | 'suggest' | 'explicit';\n  cost?: number;\n}\n```\n\n**Spec:** compiler-final/ARCHITECTURE-RECOMMENDATIONS.md Part 3\n**Test Strategy:** Unified registry serves both lens and adapter queries","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-02T05:16:41.32548-07:00","updated_at":"2026-01-02T05:16:41.32548-07:00","dependencies":[{"issue_id":"oscilla-animator_codex-pvt","depends_on_id":"oscilla-animator_codex-bjo","type":"blocks","created_at":"2026-01-02T05:17:10.602582-07:00","created_by":"daemon"}]}
{"id":"oscilla-animator_codex-vgj","title":"v2-adapter-implementation","description":"Implement the V2 adapter stub to allow legacy bridge blocks to work with the new IR compiler. Key bridge between V1 closures and V2 IR.\n\n**Current state:**\n```typescript\n// src/editor/compiler/v2adapter.ts - STUB\nexport function adaptV2Compiler(v2Compiler: BlockCompilerV2): BlockCompiler {\n  return {\n    compile(_compileArgs) {\n      return { /* Error artifacts */ };\n    }\n  };\n}\n```\n\n**Target state:**\n- Create SignalExprBuilder for block\n- Convert input Artifacts to SigExprId references\n- Call v2Compiler.compileV2() to get output SigExprIds\n- Wrap outputs as closures that call evalSig() at runtime\n\n**Key challenge:** Mix V1 closures with V2 IR via closureNode approach:\n```typescript\ncase 'closure':  // V1 bridge leaf node\n  return node.closureFn(ctx);\n```\n\n**Files to modify:**\n- src/editor/compiler/v2adapter.ts - Full implementation\n- src/editor/compiler/ir/types.ts - Add SignalExprClosure node type\n- src/editor/runtime/executor/evalSig.ts - Handle closure nodes\n\n**Spec:** compiler-final/ARCHITECTURE-RECOMMENDATIONS.md Part 4\n**Test Strategy:** V2 block with V1 closure inputs produces correct output","status":"open","priority":0,"issue_type":"feature","created_at":"2026-01-02T05:16:36.934412-07:00","updated_at":"2026-01-02T05:16:36.934412-07:00","dependencies":[{"issue_id":"oscilla-animator_codex-vgj","depends_on_id":"oscilla-animator_codex-bjo","type":"blocks","created_at":"2026-01-02T05:17:07.433712-07:00","created_by":"daemon"},{"issue_id":"oscilla-animator_codex-vgj","depends_on_id":"oscilla-animator_codex-cf6","type":"blocks","created_at":"2026-01-02T05:17:08.695554-07:00","created_by":"daemon"}]}
